function showTeamForm() {
    jQuery("#addteamform").show(400, function() {});
}

function showComForm() {
    jQuery("#dashboard-widgets").show(400, function() {});
}

function changeTeamYear() {
	window.location = "?page=teams&year=" + jQuery("#team-year").val();
}

ids = [];
full = [];
suggestions = [];
lock = false;
page = '/wp-admin/admin.php?page=stippen&action=edit_user&noheader=true&id=';

jQuery(document).ready(function(){
    if(window.location.href.indexOf("page=stippen") > -1 &&
    	window.location.href.indexOf("action=user") == -1) {
	    jQuery.ajax({
	    	dataType: "json",
	    	url: "/wp-content/plugins/Leden/api/GetMemberList.php?class=current",
			success: function (result) {
				for (var i = 0; i < result.length; i++) {
					suggestions.push(result[i].full_name);
					full[result[i].full_name] = result[i].user_id;
				}

			    jQuery("#searchinput").autocomplete({
			        // To autocomplete the input field.
			        source : function(req, resp) {
			            var res = jQuery.ui.autocomplete.filter(suggestions, req.term);
			            resp(res.slice(0,10));
			        },
			        // To refresh the page with selected user profile.
			        select: function(event, ui) {	
			            searchOnSubmit(ui.item.value);
			            return false;
			        }
			    });
			    if (jQuery("#searchinput").val())
			        return searchOnSubmit();
			}
		});
	}

	jQuery('#check-all:checkbox').change(function() {
		if (this.checked)
	    	jQuery('input:checkbox').attr('checked','checked');
	    else
	    	jQuery('input:checkbox').removeAttr('checked');
	});
});

function searchOnSubmit(value) {
	table = jQuery('#searchresults');

	var input = jQuery('#searchinput').val().toLowerCase();
	var results = [];
	var temp = [];
	var stippen = ['b', 'd', 'i', 's', 'K', 'ib'];

	jQuery.each(suggestions, function(i, el) {
		if (el.toLowerCase().indexOf(input) > -1)
			temp.push(el);
	});

	jQuery.each(temp, function(i, el) {
		if (jQuery.inArray(el, results) === -1) results.push(el);
	});

	var table = jQuery('#stip-results');

	table.empty();
	var conv_array = {0: 0, C: 1, B: 2, A: 3};

	if (results.length == 1) {
		jQuery("#person-stippen").hide(200);
		jQuery("#stc-loading").show(200);
	    jQuery.ajax({
	    	dataType: "json",
	    	url: "/wp-content/plugins/rextc-toolkit/api/userstippen.php",
	    	data: {"id" : full[results[0]]},
			success: function (result) {
				if (result) {
					for (var i = 0; i < stippen.length; i++) {
						var stip = jQuery('#stc-stip-' + stippen[i]);
						if (stippen[i] in result) {
							if (stippen[i] == 'K') 
								document.getElementById('stc-stip-' + stippen[i]).selectedIndex = conv_array[result[stippen[i]]];
							else
								document.getElementById('stc-stip-' + stippen[i]).selectedIndex = result[stippen[i]];

						}
						else {
							document.getElementById('stc-stip-' + stippen[i]).selectedIndex = 0;
						}
					}
				}

				jQuery("#stc-stipsubmitform").attr("action", page + full[results[0]]);
				jQuery("#person-name").text(results[0]);
				jQuery("#person-stippen").show(200);
				jQuery("#stc-loading").hide(200);
			}
		});
		return false;
	}

	table.show();

	jQuery("#searchinput").autocomplete("close");
	return false;
}

function alternateTable() {
	var count = 1;
	jQuery("#committee-rights tr").each(function(index, item) {
		item = jQuery(item);
		if (!item.is(':visible'))
			return;

		if (count % 2 == 1)
			item.addClass("alternate");
		else {
			if (item.hasClass("alternate")) {
				item.removeClass("alternate");
			}
		}
		count++;
	});
}

function sortRights() {
	var c = jQuery("#committee-rights-class").val();
	if (c == "all") {
		jQuery("#committee-rights tr").show();
		alternateTable();
	}
	else {
		jQuery("#committee-rights tr").hide();
		jQuery("#committee-rights-header").show();
		jQuery("#committee-rights tr." + c).show();
		alternateTable();
	}
}

var committeesApplyLast = -1;

function committeesApplyCollapse(id) {
	if (committeesApplyLast > -1) {
		jQuery("#committees-apply-info-" + committeesApplyLast).hide();
	}

	if (committeesApplyLast != id) {
		jQuery("#committees-apply-info-" + id).show();
		committeesApplyLast = id;
	}
	else {
		committeesApplyLast = -1;
	}
}